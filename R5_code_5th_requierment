### Get top 10 customer by % over total global of net sales ( Attached image of chart ), FY in 2021

WITH CTE AS
(SELECT 
    customer,
    ROUND(SUM(net_sale)/1000000,2) As total_net_sale_mil
FROM
    gdb0041.net_sale
WHERE fiscal_year = 2021
GROUP BY customer
ORDER BY total_net_sale_mil DESC
LIMIT 10
)
SELECT *,
	total_net_sale_mil*100/SUM(total_net_sale_mil) OVER () AS contribution_pct,
    RANK () OVER (ORDER BY total_net_sale_mil DESC) AS Ranking
FROM CTE 
---
